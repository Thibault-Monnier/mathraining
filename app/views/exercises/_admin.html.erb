<!-- Essais des élèves -->
<% if f.online %>

<script type="text/javascript">
function showStuff2() {
  document.getElementById("explanation2").style.display = 'inline';
  document.getElementById("show2").style.display = 'none';
  document.getElementById("hide2").style.display = 'inline';
}
function hideStuff2() {
  document.getElementById("explanation2").style.display = 'none';
  document.getElementById("show2").style.display = 'inline';
   document.getElementById("hide2").style.display = 'none';
  
}
</script>
<br/>
<a href='#' id='show2' onclick='showStuff2(); return false;' style='display:inline;' class='btn btn-default btn-grey'>Essais des étudiants</a>
<a href='#' id='hide2' style='display:none;' class='btn btn-default btn-grey' onclick='hideStuff2(); return false;'>Essais des étudiants</a>
<span id='explanation2' style='display:none;'><br/><br/>
Corrects :
<% compte = 0 %>
<% tries = f.solvedexercises.includes(:user).order(:updated_at).all if type == 2 %>
<% tries = f.solvedqcms.includes(:user).order(:updated_at).all if type == 3 %>
<% tries.each do |se| %>
  <% if se.correct %>
    <% if compte > 0 %>
      <%= " - " %>
    <% end %>
    <% compte = compte+1 %>
    <%= raw(se.user.linked_name) %>
    <%= "(#{se.nb_guess-1})" if se.nb_guess-1 > 0 %>
  <% end %>
<% end %>
<% if compte == 0 %>
  <%= "Aucune résolution." %>
<% end %>
<br/><br/>
Incorrects :
<% compte = 0 %>
<% tries = f.solvedexercises.order(:updated_at).all if type == 2 %>
<% tries = f.solvedqcms.order(:updated_at).all if type == 3 %>
<% tries.each do |se| %>
  <% if !se.correct %>
    <% if compte > 0 %>
      <%= " - " %>
    <% end %>
    <% compte = compte+1 %>
    <%= raw(se.user.linked_name) %>
    (<%= se.nb_guess %>)
  <% end %>
<% end %>
<% if compte == 0 %>
  <%= "Aucun utilisateur bloqué." %>
<% end %>
</span>
<br/><br/>

<% end %>
  
<!-- Explication -->
<h4>Explication</h4>
<% if f.explanation.size == 0 %>
  <p style="color:orange;"><b>Pas d'explication</b></p>
<% else %>
  <%= raw(htmlise(f.explanation)) %>
  <br/>
<% end %>
<br/>

<!-- Modifier / Supprimer -->
<div class="noprint">
<center>
  <% if type == 2 %>
    <% if f.online %>
      <%= link_to "Modifier cet exercice", edit_exercise_path(f), data: { confirm: "Attention, cet exercice étant visible des utilisateurs, tâchez de ne pas faire de modifications majeures." } %> |
      <%= link_to "Modifier l'explication", exercise_explanation_path(f) %>
    <% else %>
      <%= link_to "Modifier cet exercice", edit_exercise_path(f) %> |
      <%= link_to "Modifier l'explication", exercise_explanation_path(f) %> |
      <%= link_to "Supprimer cet exercice", f, method: :delete, data: { confirm: "Êtes-vous sûr de vouloir supprimer cet exercice ?" } %>
    <% end %>
  <% else %>
    <% if f.online %>
      <%= link_to "Modifier ce QCM", edit_qcm_path(f), data: { confirm: "Attention, ce QCM étant visible des utilisateurs, tâchez de ne pas faire de modifications majeures." }  %> |
      <%= link_to "Modifier les réponses de ce QCM", qcm_manage_choices_path(f), data: { confirm: "Attention, QCM étant visible des utilisateurs, tâchez de ne pas faire de modifications majeures." } %> |
      <%= link_to "Modifier l'explication", qcm_explanation_path(f) %>
    <% else %>
      <%= link_to "Modifier ce QCM", edit_qcm_path(f) %> |
      <%= link_to "Modifier les réponses de ce QCM", qcm_manage_choices_path(f) %> |
      <%= link_to "Modifier l'explication", qcm_explanation_path(f) %> |
      <%= link_to "Supprimer ce QCM", f, method: :delete, data: { confirm: "Êtes-vous sûr de vouloir supprimer ce QCM ?" } %>
    <% end %>
  <% end %>
<br/><br/>
  
<!-- Déplacer -->
<% if number2 > 1 %>
  <% up = true %>
<% else %>
  <% up = false %>
<% end %>

<% if number2 < number_tot %>
  <% down = true %>
<% else %>
  <% down = false %>
<% end %>

<% if (up || down) %>
  <% if type == 2 %>
    Déplacer cet exercice vers le
    <% if up %>
      <%= link_to "haut", exercise_order_minus_path(f) %>
      <% if down %>
        | <%= link_to "bas", exercise_order_plus_path(f) %>
      <% end %>
    <% else %>
      <%= link_to "bas", exercise_order_plus_path(f) %>
    <% end %>
  <% else %>
    Déplacer ce QCM vers le
    <% if up %>
      <%= link_to "haut", qcm_order_minus_path(f) %>
      <% if down %>
        | <%= link_to "bas", qcm_order_plus_path(f) %>
      <% end %>
    <% else %>
      <%= link_to "bas", qcm_order_plus_path(f) %>
    <% end %>
  <% end %>
<br/><br/>
<% end %>

<!-- Mettre en ligne -->
<% if !f.online && @chapter.online %>
  <% if type == 2 %>
    <%= button_to "Mettre en ligne", exercise_put_online_path(f), method: :get, class: 'btn btn-default btn-grey', data: { confirm: "Vous ne pourrez plus modifier la réponse de cet exercice par la suite. Êtes-vous sûr de vouloir le mettre en ligne ?" } %>
  <% else %>
    <%= button_to "Mettre en ligne", qcm_put_online_path(f), method: :get, class: 'btn btn-default btn-grey', data: { confirm: "Vous ne pourrez plus modifier la réponse de ce qcm par la suite. Êtes-vous sûr de vouloir le mettre en ligne ?" } %>
  <% end %>
  <br/>
<% end %>
</center>
</div>
