<% postfix = "NewMessage" %>

<div id="the<%= postfix %>" class="myoverflow text-center">
<button onclick='return Rolling.develop("<%= postfix %>")' class='btn btn-lg btn-light mt-3'>RÃ©pondre</button>
</div>

<div id="form<%= postfix %>" class="myoverflow px-1" style="height:0px;">

<% @message = Message.new %>
<%= form_for [@subject, @message], :url => subject_messages_path(@subject, @message, :action => :create, :q => @q), :html => { :multipart => true, :class => "mt-3" } do |f| %>
  <%= render 'messages/form', f: f, m: @message, postfix: postfix, show_mail_checkboxes: true %>
  <%= render 'shared/edit_files', postfix: postfix %>
  
  <% lastid = -1 %>
  <% lastmessage = @subject.messages.order("id DESC").first %>
  <% if !lastmessage.nil? %>
    <% lastid = lastmessage.id %>
  <% end %>
  <input type="hidden" name="lastmessage" value="<%= lastid %>">

  <%= f.submit "Poster", class: "btn btn-lg btn-primary", :disabled => current_user.other %>
  <button class="btn btn-lg btn-light" onclick="return Rolling.hideActual();">Annuler</button>
<% end %>

</div>
