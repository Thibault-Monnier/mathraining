<script>allowhide = false</script> <!-- This disables the "[hide][/hide]" in previewsafe -->

<% @ancientexte = session[:ancientexte] %>
<% session[:ancientexte] = nil %>

<%= form_for :submission, url: problem_submissions_path(problem), :html => { :multipart => true } do |f| %>

  <!-- Nouvelle soumission -->
  <h3>Nouvelle soumission</h3>
  
  <%= render 'submissions/form', f: f %>

  <!-- Pièces jointes -->
  <span id="fooBar"></span>

  <input type="button" value="Ajouter une pièce jointe" onclick="Joint.add()" <%= 'disabled="disabled"' if current_user.other %> />
  <br/><br/>

  <%= f.submit "Soumettre cette solution", class: "btn btn-primary", style: "margin-bottom:5px;", :disabled => (!signed_in? || current_user.other), data: { confirm: "Êtes-vous sûr de vouloir soumettre cette solution ?" } %>
  <%= f.submit "Enregistrer comme brouillon", class: "btn btn-default btn-grey", style: "margin-bottom:5px;", :disabled => (!signed_in? || current_user.other) %>
  <% if !signed_in? %>
    <hr style="border-top:1px dashed lightgray;" />
    <center>Pour pouvoir faire une soumission, vous devez être connecté.</center>
  <% end %>
<% end %>

<script>
PreviewSafe.Init();
PreviewSafe.Update();
</script>
